//---------------------------------------------------------------------------

#include <vcl.h>
#pragma hdrstop

#include "Unit6.h"
#include "Unit5.h"
//---------------------------------------------------------------------------
#pragma package(smart_init)
#pragma resource "*.dfm"
TForm6 *Form6;
//---------------------------------------------------------------------------
__fastcall TForm6::TForm6(TComponent* Owner)
	: TForm(Owner)
{
}
//---------------------------------------------------------------------------
void __fastcall TForm6::Button1Click(TObject *Sender)
{
	bool checker = true;
	ADOQuery1->First();
	while(!ADOQuery1->Eof){
		if(ADOQuery1->FieldByName("ФИО")->AsString == Edit1->Text){
			checker = false;
		}
		ADOQuery1->Next();
	}
	if(checker == true){
		ADOQuery1->Insert();
		ADOQuery1->FieldByName("ФИО")->AsString = Edit1->Text;
		ADOQuery1->FieldByName("Возраст")->AsString = Edit1->Text;
		ADOQuery1->FieldByName("Возможные_работы")->AsString = ComboBox1->Text;

		ADOQuery1->Post();
		Label1->Visible = true;
		Timer1->Enabled = true;
	}
	else{
		ShowMessage("Данный рабочий уже находится в базе данных!");
	}
}
//---------------------------------------------------------------------------


void __fastcall TForm6::Timer1Timer(TObject *Sender)
{
    Label1->Visible = false;
	Timer1->Enabled = false;
}
//---------------------------------------------------------------------------

void __fastcall TForm6::Timer2Timer(TObject *Sender)
{
    void __fastcall TForm4::Button3Click(TObject *Sender)
{
	UnicodeString s;
	bool add = true;
	Form5->ADOQuery1->First();
	 while(!Form5->ADOQuery1->Eof){
		if(ADOQuery1->Fields->FieldByName("Наименование_работы")->AsString != ""){
		s = Form5->ADOQuery1->Fields->FieldByName("Наименование_работы")->AsString;
			for(int i = 0;i<ComboBox1->Items->Count;i++){
				if(s == ComboBox1->Items->Strings[i]){
					add = false;
				}
			}
		}
		if(add == false){
			ADOQuery1->Next();
            add = true;
		}
		else{
			ComboBox1->Items->Add(s);
			ADOQuery1->Next();
        }
	 }
}
}
//---------------------------------------------------------------------------

